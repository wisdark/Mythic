table:
  name: token
  schema: public
object_relationships:
  - name: logonsession
    using:
      foreign_key_constraint_on: AuthenticationId_id
  - name: task
    using:
      foreign_key_constraint_on: task_id
array_relationships:
  - name: callbacktokens
    using:
      foreign_key_constraint_on:
        column: token_id
        table:
          name: callbacktoken
          schema: public
  - name: tasks
    using:
      foreign_key_constraint_on:
        column: token_id
        table:
          name: task
          schema: public
select_permissions:
  - role: developer
    permission:
      columns:
        - id
        - TokenId
        - User
        - Groups
        - EnabledGroups
        - DenyOnlyGroups
        - GroupCount
        - AuthenticationId_id
        - TokenType
        - ExpirationTime
        - ModifiedId
        - Owner
        - PrimaryGroup
        - DefaultDacl
        - Source
        - RestrictedSids
        - RestrictedSidsCount
        - ImpersonationLevel
        - SessionId
        - SandboxInert
        - Origin
        - ElevationType
        - Elevated
        - HasRestrictions
        - UIAccess
        - VirtualizationAllowed
        - VirtualizationEnabled
        - Restricted
        - WriteRestricted
        - Filtered
        - NotLow
        - Flags
        - NoChildProcess
        - Capabilities
        - MandatoryPolicy
        - LogonSid
        - IntegrityLevelSid
        - AppContainerNumber
        - IntegrityLevel
        - SecurityAttributes
        - DeviceClaimAttributes
        - UserClaimAttributes
        - RestrictedUserClaimAttributes
        - RestrictedDeviceClaimAttributes
        - AppContainer
        - LowPrivilegeAppContainer
        - AppContainerSid
        - PackageName
        - DeviceGroups
        - RestrictedDeviceGroups
        - Privileges
        - FullPath
        - TrustLevel
        - IsPseudoToken
        - IsSandbox
        - PackageFullName
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - BnoIsolationPrefix
        - PackageIdentity
        - AuditPolicy
        - PrivateNamespace
        - IsRestricted
        - ProcessUniqueAttribute
        - GrantedAccess
        - GrantedAccessGeneric
        - GrantedAccessMask
        - SecurityDescriptor
        - Sddl
        - Handle
        - NtTypeName
        - NtType
        - Name
        - CanSynchronize
        - CreationTime
        - AttributesFlags
        - HandleReferenceCount
        - PointerReferenceCount
        - Inherit
        - ProtectFromClose
        - Address
        - IsContainer
        - IsClosed
        - os
        - task_id
        - timestamp_created
        - deleted
        - host
        - ThreadID
        - process
        - description
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      allow_aggregations: true
  - role: mythic_admin
    permission:
      columns:
        - Address
        - AppContainer
        - AppContainerNumber
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AttributesFlags
        - AuditPolicy
        - AuthenticationId_id
        - BnoIsolationPrefix
        - CanSynchronize
        - Capabilities
        - CreationTime
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - Elevated
        - ElevationType
        - EnabledGroups
        - ExpirationTime
        - Filtered
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - GrantedAccessMask
        - GroupCount
        - Groups
        - Handle
        - HandleReferenceCount
        - HasRestrictions
        - ImpersonationLevel
        - Inherit
        - IntegrityLevel
        - IntegrityLevelSid
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LogonSid
        - LowPrivilegeAppContainer
        - MandatoryPolicy
        - ModifiedId
        - Name
        - NoChildProcess
        - NotLow
        - NtType
        - NtTypeName
        - Origin
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PointerReferenceCount
        - PrimaryGroup
        - PrivateNamespace
        - Privileges
        - ProcessUniqueAttribute
        - ProtectFromClose
        - Restricted
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - SandboxInert
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - SessionId
        - Source
        - ThreadID
        - TokenId
        - TokenType
        - TrustLevel
        - UIAccess
        - User
        - UserClaimAttributes
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - description
        - host
        - id
        - os
        - process
        - task_id
        - timestamp_created
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      allow_aggregations: true
  - role: operation_admin
    permission:
      columns:
        - CreationTime
        - AppContainer
        - CanSynchronize
        - Elevated
        - Filtered
        - HasRestrictions
        - Inherit
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LowPrivilegeAppContainer
        - NoChildProcess
        - NotLow
        - PrivateNamespace
        - ProtectFromClose
        - Restricted
        - SandboxInert
        - UIAccess
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - Address
        - AppContainerNumber
        - AttributesFlags
        - AuthenticationId_id
        - ElevationType
        - GrantedAccessMask
        - GroupCount
        - Handle
        - HandleReferenceCount
        - ImpersonationLevel
        - IntegrityLevel
        - IntegrityLevelSid
        - ModifiedId
        - NtType
        - Origin
        - PointerReferenceCount
        - SessionId
        - ThreadID
        - TokenId
        - TokenType
        - id
        - process
        - task_id
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AuditPolicy
        - BnoIsolationPrefix
        - Capabilities
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - EnabledGroups
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - Groups
        - LogonSid
        - MandatoryPolicy
        - Name
        - NtTypeName
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PrimaryGroup
        - Privileges
        - ProcessUniqueAttribute
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - Source
        - TrustLevel
        - User
        - UserClaimAttributes
        - description
        - host
        - os
        - ExpirationTime
        - timestamp_created
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      allow_aggregations: true
  - role: operator
    permission:
      columns:
        - CreationTime
        - AppContainer
        - CanSynchronize
        - Elevated
        - Filtered
        - HasRestrictions
        - Inherit
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LowPrivilegeAppContainer
        - NoChildProcess
        - NotLow
        - PrivateNamespace
        - ProtectFromClose
        - Restricted
        - SandboxInert
        - UIAccess
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - Address
        - AppContainerNumber
        - AttributesFlags
        - AuthenticationId_id
        - ElevationType
        - GrantedAccessMask
        - GroupCount
        - Handle
        - HandleReferenceCount
        - ImpersonationLevel
        - IntegrityLevel
        - IntegrityLevelSid
        - ModifiedId
        - NtType
        - Origin
        - PointerReferenceCount
        - SessionId
        - ThreadID
        - TokenId
        - TokenType
        - id
        - process
        - task_id
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AuditPolicy
        - BnoIsolationPrefix
        - Capabilities
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - EnabledGroups
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - Groups
        - LogonSid
        - MandatoryPolicy
        - Name
        - NtTypeName
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PrimaryGroup
        - Privileges
        - ProcessUniqueAttribute
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - Source
        - TrustLevel
        - User
        - UserClaimAttributes
        - description
        - host
        - os
        - ExpirationTime
        - timestamp_created
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      allow_aggregations: true
  - role: spectator
    permission:
      columns:
        - CreationTime
        - AppContainer
        - CanSynchronize
        - Elevated
        - Filtered
        - HasRestrictions
        - Inherit
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LowPrivilegeAppContainer
        - NoChildProcess
        - NotLow
        - PrivateNamespace
        - ProtectFromClose
        - Restricted
        - SandboxInert
        - UIAccess
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - Address
        - AppContainerNumber
        - AttributesFlags
        - AuthenticationId_id
        - ElevationType
        - GrantedAccessMask
        - GroupCount
        - Handle
        - HandleReferenceCount
        - ImpersonationLevel
        - IntegrityLevel
        - IntegrityLevelSid
        - ModifiedId
        - NtType
        - Origin
        - PointerReferenceCount
        - SessionId
        - ThreadID
        - TokenId
        - TokenType
        - id
        - process
        - task_id
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AuditPolicy
        - BnoIsolationPrefix
        - Capabilities
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - EnabledGroups
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - Groups
        - LogonSid
        - MandatoryPolicy
        - Name
        - NtTypeName
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PrimaryGroup
        - Privileges
        - ProcessUniqueAttribute
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - Source
        - TrustLevel
        - User
        - UserClaimAttributes
        - description
        - host
        - os
        - ExpirationTime
        - timestamp_created
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      allow_aggregations: true
update_permissions:
  - role: developer
    permission:
      columns:
        - Address
        - AppContainer
        - AppContainerNumber
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AttributesFlags
        - AuditPolicy
        - AuthenticationId_id
        - BnoIsolationPrefix
        - CanSynchronize
        - Capabilities
        - CreationTime
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - Elevated
        - ElevationType
        - EnabledGroups
        - ExpirationTime
        - Filtered
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - GrantedAccessMask
        - GroupCount
        - Groups
        - Handle
        - HandleReferenceCount
        - HasRestrictions
        - ImpersonationLevel
        - Inherit
        - IntegrityLevel
        - IntegrityLevelSid
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LogonSid
        - LowPrivilegeAppContainer
        - MandatoryPolicy
        - ModifiedId
        - Name
        - NoChildProcess
        - NotLow
        - NtType
        - NtTypeName
        - Origin
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PointerReferenceCount
        - PrimaryGroup
        - PrivateNamespace
        - Privileges
        - ProcessUniqueAttribute
        - ProtectFromClose
        - Restricted
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - SandboxInert
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - SessionId
        - Source
        - ThreadID
        - TokenId
        - TokenType
        - TrustLevel
        - UIAccess
        - User
        - UserClaimAttributes
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - description
        - host
        - process
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      check: null
  - role: mythic_admin
    permission:
      columns:
        - Address
        - AppContainer
        - AppContainerNumber
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AttributesFlags
        - AuditPolicy
        - AuthenticationId_id
        - BnoIsolationPrefix
        - CanSynchronize
        - Capabilities
        - CreationTime
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - Elevated
        - ElevationType
        - EnabledGroups
        - ExpirationTime
        - Filtered
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - GrantedAccessMask
        - GroupCount
        - Groups
        - Handle
        - HandleReferenceCount
        - HasRestrictions
        - ImpersonationLevel
        - Inherit
        - IntegrityLevel
        - IntegrityLevelSid
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LogonSid
        - LowPrivilegeAppContainer
        - MandatoryPolicy
        - ModifiedId
        - Name
        - NoChildProcess
        - NotLow
        - NtType
        - NtTypeName
        - Origin
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PointerReferenceCount
        - PrimaryGroup
        - PrivateNamespace
        - Privileges
        - ProcessUniqueAttribute
        - ProtectFromClose
        - Restricted
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - SandboxInert
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - SessionId
        - Source
        - ThreadID
        - TokenId
        - TokenType
        - TrustLevel
        - UIAccess
        - User
        - UserClaimAttributes
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - description
        - host
        - process
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      check: null
  - role: operation_admin
    permission:
      columns:
        - Address
        - AppContainer
        - AppContainerNumber
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AttributesFlags
        - AuditPolicy
        - AuthenticationId_id
        - BnoIsolationPrefix
        - CanSynchronize
        - Capabilities
        - CreationTime
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - Elevated
        - ElevationType
        - EnabledGroups
        - ExpirationTime
        - Filtered
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - GrantedAccessMask
        - GroupCount
        - Groups
        - Handle
        - HandleReferenceCount
        - HasRestrictions
        - ImpersonationLevel
        - Inherit
        - IntegrityLevel
        - IntegrityLevelSid
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LogonSid
        - LowPrivilegeAppContainer
        - MandatoryPolicy
        - ModifiedId
        - Name
        - NoChildProcess
        - NotLow
        - NtType
        - NtTypeName
        - Origin
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PointerReferenceCount
        - PrimaryGroup
        - PrivateNamespace
        - Privileges
        - ProcessUniqueAttribute
        - ProtectFromClose
        - Restricted
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - SandboxInert
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - SessionId
        - Source
        - ThreadID
        - TokenId
        - TokenType
        - TrustLevel
        - UIAccess
        - User
        - UserClaimAttributes
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - description
        - host
        - process
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      check: null
  - role: operator
    permission:
      columns:
        - Address
        - AppContainer
        - AppContainerNumber
        - AppContainerSid
        - AppId
        - AppModelPolicies
        - AppModelPolicyDictionary
        - AttributesFlags
        - AuditPolicy
        - AuthenticationId_id
        - BnoIsolationPrefix
        - CanSynchronize
        - Capabilities
        - CreationTime
        - DefaultDacl
        - DenyOnlyGroups
        - DeviceClaimAttributes
        - DeviceGroups
        - Elevated
        - ElevationType
        - EnabledGroups
        - ExpirationTime
        - Filtered
        - Flags
        - FullPath
        - GrantedAccess
        - GrantedAccessGeneric
        - GrantedAccessMask
        - GroupCount
        - Groups
        - Handle
        - HandleReferenceCount
        - HasRestrictions
        - ImpersonationLevel
        - Inherit
        - IntegrityLevel
        - IntegrityLevelSid
        - IsClosed
        - IsContainer
        - IsPseudoToken
        - IsRestricted
        - IsSandbox
        - LogonSid
        - LowPrivilegeAppContainer
        - MandatoryPolicy
        - ModifiedId
        - Name
        - NoChildProcess
        - NotLow
        - NtType
        - NtTypeName
        - Origin
        - Owner
        - PackageFullName
        - PackageIdentity
        - PackageName
        - PointerReferenceCount
        - PrimaryGroup
        - PrivateNamespace
        - Privileges
        - ProcessUniqueAttribute
        - ProtectFromClose
        - Restricted
        - RestrictedDeviceClaimAttributes
        - RestrictedDeviceGroups
        - RestrictedSids
        - RestrictedSidsCount
        - RestrictedUserClaimAttributes
        - SandboxInert
        - Sddl
        - SecurityAttributes
        - SecurityDescriptor
        - SessionId
        - Source
        - ThreadID
        - TokenId
        - TokenType
        - TrustLevel
        - UIAccess
        - User
        - UserClaimAttributes
        - VirtualizationAllowed
        - VirtualizationEnabled
        - WriteRestricted
        - deleted
        - description
        - host
        - process
      filter:
        task:
          callback:
            operation_id:
              _in: X-Hasura-operations
      check: null
